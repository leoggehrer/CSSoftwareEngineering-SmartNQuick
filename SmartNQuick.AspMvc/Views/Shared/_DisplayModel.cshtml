@*@BaseCode*@
@{
    @using SmartNQuick.AspMvc.Modules.Language
    @using SmartNQuick.AspMvc.Modules.View
    @model SmartNQuick.AspMvc.Models.IdentityModel

    var viewBagWrapper = new ViewBagWrapper(ViewBag);
    var controller = ViewContext.RouteData.Values["controller"].ToString();
    var action = ViewContext.RouteData.Values["action"].ToString();
    var displayViewModel = viewBagWrapper.CreateDisplayViewModel(controller, Model);

    viewBagWrapper.Translate = Translator.TranslateIt;
    viewBagWrapper.TranslateFor = pn => viewBagWrapper.Translate($"{controller}.{pn}");
    Model.ViewBagInfo = viewBagWrapper;

    @foreach (var item in displayViewModel.DisplayProperties)
    {
        Model.ViewBagInfo.Handled = false;
        Model.ViewBagInfo.DisplayProperty = item;

        <dl class="row">
            <dt class="col-sm-2">
                @viewBagWrapper.TranslateFor(displayViewModel.GetLabel(item))
            </dt>
            <dd class="col-sm-10">
                @await Html.PartialAsync("_DisplayControl", Model)
                @if (Model.ViewBagInfo.Handled == false)
                {
                    @displayViewModel.GetDisplayValue(item)
                }
            </dd>
        </dl>
    }
}